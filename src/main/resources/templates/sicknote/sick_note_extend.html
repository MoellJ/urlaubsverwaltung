<!doctype html>
<html lang="en" th:lang="${language}" th:class="|tw-${theme}|" xmlns:th="http://www.thymeleaf.org">
  <head
    th:replace="~{_layout::head(title=~{::title}, styles=~{::styles}, scripts=~{::scripts}, scriptsDefer=~{::scriptsDefer}, preload=~{::preload})}"
  >
    <title th:text="#{sicknote.extend.header.title}">Krankmeldung erweitern</title>
    <th:block th:fragment="styles">
      <link rel="stylesheet" th:href="@{/css/sick-note-extend.css}" />
    </th:block>
    <th:block th:fragment="scripts">
      <script th:inline="javascript">
        /*<![CDATA[*/
        window.uv = window.uv || {};
        window.uv.personId = /*[[${sickNotePersonId}]]*/ "personId";
        window.uv.webPrefix = /*[[@{/web}]]*/ "/web";
        window.uv.apiPrefix = /*[[@{/api}]]*/ "/api";
        /*]]>*/
      </script>
      <script th:replace="~{fragments/datepicker-localization :: datepicker-localization}"></script>
    </th:block>
    <th:block th:fragment="preload">
      <link rel="preload" th:replace="~{fragments/asset-dependency-preload::links('sick_note_extend.js')}" />
    </th:block>
    <th:block th:fragment="scriptsDefer">
      <script defer type="module" asset:src="sick_note_extend.js"></script>
    </th:block>
  </head>
  <body th:replace="~{_layout::body(~{::main}, ~{})}">
    <main th:fragment="main">
      <div class="tw-max-w-2xl lg:tw-max-w-6xl tw-mx-auto tw-px-4 md:tw-px-0 lg:tw-px-12 xl:tw-px-0">
        <h1 class="tw-sr-only" th:text="#{absences.overview.sick}">Krankmeldung</h1>
        <div class="tw-flex tw-gap-2">
          <a href="#" th:href="@{/web/sicknote/new (noExtensionRedirect)}" class="button button-main tw-flex tw-gap-1">
            <svg th:replace="~{icon/plus::svg(className='tw-w-4 tw-h-4')}"></svg>
            <th:block th:text="#{sicknote.extend.create-new.button.text}">neue Krankmeldung</th:block>
          </a>
          <a
            href="#"
            th:href="@{/web/sicknote/new (noExtensionRedirect=${''}, category=${'SICK_NOTE_CHILD'})}"
            class="button button-main tw-flex tw-gap-1"
          >
            <svg th:replace="~{icon/plus::svg(className='tw-w-4 tw-h-4')}"></svg>
            <th:block th:text="#{sicknote.extend.create-new.child.button.text}">neue Kind-Krankmeldung</th:block>
          </a>
        </div>
        <div th:if="${showFillFormFeedback}" class="tw-mt-8">
          <p class="alert alert--outline alert-danger" th:text="#{sicknote.extend.fill-form-feedback}">
            Gebe bitte noch an, wie viele Tage du voraussichtlich noch krank sein wirst.
          </p>
        </div>
        <h2 class="tw-mt-12" th:text="#{sicknote.extend.title}">Weiter Krank melden</h2>
        <p
          class="tw-m-0 tw-mt-8"
          th:text="#{sicknote.extend.paragraph.current(${#temporals.format(sickNote.startDate, 'FULL')}, ${sickNoteEndDateWord})}"
        >
          Du hast eine Krankmeldung von <em>xx.xx.xxxx</em> bis <em>gestern</em>.
        </p>
        <p class="tw-m-0 tw-mt-0.5" th:text="#{sicknote.extend.paragraph.duration}">
          Wie lange bist du vorraussichtlich noch krank?
        </p>
        <div class="tw-mt-8">
          <form
            method="post"
            action="#"
            th:action="@{/web/sicknote/extend}"
            class="tw-mt-8 tw-space-y-8"
            th:bind="${sickNote}"
          >
            <div class="extend-action-grid tw-max-w-3xl">
              <button
                type="submit"
                class="button"
                th:href="@{/web/sicknote/extend (extend=1)}"
                th:classappend="${selectedExtend == '1' ? 'tw-bg-blue-400' : ''}"
                th:text="#{sicknote.extend.duration.plus-workday.label(1)}"
                name="extend"
                value="1"
              >
                + 1 Tag
              </button>
              <span
                class="tw-text-sm"
                th:with="word=${'<span class=tw-block>' + plusOneWorkdayWord + '</span>'}"
                th:utext="#{sicknote.extend.duration.hint.label(${word})}"
              >
                einschließlich heute
              </span>
              <button
                type="submit"
                class="button"
                th:href="@{/web/sicknote/extend (extend=2)}"
                th:classappend="${selectedExtend == '2' ? 'tw-bg-blue-400' : ''}"
                th:text="#{sicknote.extend.duration.plus-workday.label(2)}"
                name="extend"
                value="2"
              >
                + 2 Tage
              </button>
              <span
                class="tw-text-sm"
                th:with="word=${'<span class=tw-block>' + plusTwoWorkdaysWord + '</span>'}"
                th:utext="#{sicknote.extend.duration.hint.label(${word})}"
              >
                einschließlich morgen
              </span>
              <button
                class="button"
                th:href="@{/web/sicknote/extend (extend=${'end-of-week'})}"
                th:classappend="${selectedExtend == 'end-of-week' ? 'tw-bg-blue-400' : ''}"
                th:text="#{sicknote.extend.duration.end-of-week.label}"
                name="extend"
                value="end-of-week"
              >
                Ende der Woche
              </button>
              <span
                class="tw-text-sm"
                th:with="word=${'<span class=tw-block>' + untilEndOfWeekWord + '</span>'}"
                th:utext="#{sicknote.extend.duration.hint.label(${word})}"
              >
                einschließlich xxx
              </span>
              <input
                type="date"
                id="extend-to-date-input"
                name="extendToDate"
                class="form-control"
                th:classappend="${selectedExtend == 'custom' ? 'tw-bg-blue-400 tw-border-2 tw-border-blue-400' : ''}"
                data-auto-submit="submit-date-button"
                data-auto-submit-delay="100"
                th:value="${extendToDate}"
                th:min="${#temporals.format(today, 'yyyy-MM-dd')}"
                th:data-iso-value="${#temporals.format(extendToDate, 'yyyy-MM-dd')}"
              />
              <span>
                <label for="extend-to-date-input" th:text="#{sicknote.extend.duration.custom.label}">
                  Anderer Tag
                </label>
                <button
                  type="submit"
                  id="submit-date-button"
                  name="custom-date-preview"
                  class="button"
                  data-js-class="tw-sr-only"
                  th:text="#{sicknote.extend.duration.custom.submit.text}"
                >
                  Vorschau
                </button>
              </span>
            </div>
            <th:block
              th:fragment="sick-note-extension-preview(sickNote, sickNoteExtensionPreview)"
              th:with="sickNoteExtensionPreview=${sickNoteExtensionPreview ?: sickNoteExtended}"
            >
              <th:block th:if="${sickNoteExtensionPreview != null}">
                <div class="sick-note-extension-preview-container">
                  <div class="sick-note-extension-preview">
                    <div class="sick-note-extension-preview-card">
                      <div class="tw-font-bold" th:text="#{sicknote.extend.preview.current.title}">
                        Aktuelle Krankmeldung
                      </div>
                      <div
                        class="tw-mt-4 tw-grid tw-gap-x-8 tw-gap-y-1"
                        style="grid-template-columns: repeat(2, minmax(max-content, 1fr))"
                      >
                        <span th:text="#{sicknote.extend.preview.current.start.label}">von</span>
                        <span class="tw-text-right" th:text="${#temporals.format(sickNote.startDate, 'FULL')}">
                          xx.xx.xxxx
                        </span>
                        <span th:text="#{sicknote.extend.preview.current.end.label}">bis</span>
                        <span class="tw-text-right" th:text="${#temporals.format(sickNote.endDate, 'FULL')}">
                          xx.xx.xxxx
                        </span>
                      </div>
                      <div
                        class="tw-mt-4 tw-text-sm tw-text-right"
                        th:text="#{sicknote.extend.preview.days-between(${sickNote.workingDays})}"
                      >
                        entspricht x Arbeitstagen
                      </div>
                    </div>
                    <div class="sick-note-extension-preview-arrow">
                      <svg th:replace="~{icon/arrow-narrow-right::svg(className='tw-h-8 tw-w-16')}" />
                    </div>
                    <div class="sick-note-extension-preview-card sick-note-extension-preview-card--highlighted">
                      <div class="tw-font-bold" th:text="#{sicknote.extend.preview.new.title}">
                        Vorschau geänderte Krankmeldung
                      </div>
                      <div
                        class="tw-mt-4 tw-grid tw-gap-x-8 tw-gap-y-1"
                        style="grid-template-columns: repeat(2, minmax(max-content, 1fr))"
                      >
                        <span th:text="#{sicknote.extend.preview.new.start.label}">von</span>
                        <span
                          class="tw-text-right"
                          th:text="${#temporals.format(sickNoteExtensionPreview.startDate, 'FULL')}"
                        >
                          xx.xx.xxxx
                        </span>
                        <span th:text="#{sicknote.extend.preview.new.end.label}">Verlängerung bis</span>
                        <span
                          class="tw-text-right"
                          th:text="${#temporals.format(sickNoteExtensionPreview.endDate, 'FULL')}"
                        >
                          xx.xx.xxxx
                        </span>
                      </div>
                      <div
                        class="tw-mt-4 tw-text-sm tw-text-right"
                        th:text="#{sicknote.extend.preview.days-between(${sickNoteExtensionPreview.workingDays})}"
                      >
                        entspricht x Arbeitstagen
                      </div>
                    </div>
                  </div>
                </div>
              </th:block>
            </th:block>
            <div>
              <th:block th:if="${sickNoteExtended != null}">
                <input type="hidden" name="id" th:value="${sickNoteExtended.id}" />
                <input type="hidden" name="startDate" th:value="${sickNoteExtended.startDate}" />
                <input type="hidden" name="endDate" th:value="${sickNoteExtended.endDate}" />
                <input type="hidden" name="workingdays" th:value="${sickNoteExtended.workingDays}" />
              </th:block>
              <button
                type="submit"
                class="button-main-green tw-w-full sm:tw-w-56"
                th:text="#{sicknote.extend.form.submit.text}"
              >
                Weiter Krank melden
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>
  </body>
</html>
